#!/bin/bash
set -e

BASE_DIR=$(cd $(dirname $0)/../..; pwd)
source ${BASE_DIR}/bin/lib/init-env
source ${LIB_DIR}/export-env ${CONFIG_DIR}/.env
SERVICE_NAME=${SERVICE_NAME:-poccis}

cd ${CONFIG_DIR}

if [ "$1" = "up" ]; then
    source ${LIB_DIR}/force-recreate
    docker-compose -p poccis -f dns.yml up -d ${FORCE_RECREATE}
fi

docker-compose -p ${SERVICE_NAME} "$@"

if [ "${SERVICE_NAME}" = "poccis" -a "$1" != "up" ]; then
    docker-compose -p poccis -f dns.yml "$@"
fi
