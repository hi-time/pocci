#!/bin/bash
set -e

BASE_DIR=$(cd $(dirname $0)/../..; pwd)
source ${BASE_DIR}/bin/lib/init-env
source ${LIB_DIR}/export-env ${RUNTIME_DIR}/service-names.env

if [ -n "${JENKINS_URL}" ]; then
    if [ -f ${TEMP_CONFIG_DIR}/jenkins-slaves.yml.template ]; then
        echo "Start Jenkins slave nodes..."
        cp ${TEMP_CONFIG_DIR}/jenkins-slaves.yml.template ${CONFIG_DIR}
        ${LIB_DIR}/save-config "Add jenkins-slaves.yml.template"
        ${LIB_DIR}/jenkins-slave up -d
    fi
fi
