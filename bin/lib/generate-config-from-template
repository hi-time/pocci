#!/bin/bash
set -e

export BASE_DIR=$(cd $(dirname $0)/../..; pwd)
export CONFIG_DIR=${BASE_DIR}/config
export BIN_DIR=${BASE_DIR}/bin

if [ -d ${CONFIG_DIR} ]; then
    if [ `ls ${CONFIG_DIR} | wc -l` != "0" ]; then
        rm -fr ${CONFIG_DIR}/*
    fi
else
    mkdir ${CONFIG_DIR}
fi

cp -r ${BASE_DIR}/template/* ${CONFIG_DIR}

if [ ! -d ${CONFIG_DIR}/services/volumes ]; then
    mkdir ${CONFIG_DIR}/services/volumes
fi

for i in $(ls ${CONFIG_DIR}/services/scripts/*); do
    chmod +x $i
    $i
done

echo "rt/" >${CONFIG_DIR}/.gitignore

${BASE_DIR}/bin/lib/save-config "Create from template"
